import{P as v,r as u,L as S,H as P,K as w}from"./DOkxriL9.js";import{u as C}from"./D8gQVhjj.js";const T=v("useOrderStore",()=>{var m;const s=u({name:"xxx",email:"xxx@gmail.com",tel:"0900000000",pay_method:"超商取貨付款",address:"xxx"}),c=u({}),{cartDataInit:f}=C(),t=S(),y=P(),h=w(),{apiPath:d,apiBaseUrl:i}=h.public,a=u(((m=t==null?void 0:t.query)==null?void 0:m.orderId)||"");function l(r){a.value=r}async function I(){var e,p;const r=((e=t==null?void 0:t.query)==null?void 0:e.orderId)||a.value||"";if(console.log("myOrderId: ",r),!r)return;l(r);const n={method:"GET"};try{const o=await $fetch(`${i}/api/${d}/order/${r}`,{...n});console.log("res",o),(p=o==null?void 0:o.order)!=null&&p.id&&(c.value={...o.order,...o.order.user,orderId:r})}catch(o){console.error(o)}}async function $(){const r=`${i}/api/${d}/order`,n={method:"POST",body:{data:{user:s.value}}};try{const e=await $fetch(r,{...n});return console.log("res",e),O(),f(),e.orderId}catch(e){console.error(e)}}function g(){c.value={}}async function x(){console.log("orderId",a.value);const r=`${i}/api/${d}/pay/${a.value}`,n={method:"POST"};try{const e=await $fetch(r,{...n});console.log("res",e),y.push(`/orderComplated?orderId=${a.value}`)}catch(e){console.error(e)}}function O(){s.value={pay_method:"-請選擇付款方式-"}}return{orderId:a,orderInfoForm:s,orderPaymentData:c,getOrderId:l,getOrder:I,clearOrderData:g,sendOrder:$,payment:x}});export{T as u};
