import{D as P,r as u,s as w,M as E}from"./7L-wg891.js";const $=P("useCartDelModalStore",()=>{const l=u(!1),i=u(!1);function p(r){i.value=!!r,l.value=!0}function s(){l.value=!1}return{isDelModalShow:l,isDeleteAll:i,modalShow:p,modalHide:s}}),A=P("useCartStore",()=>{const{isDeleteAll:l}=w($()),{modalHide:i}=$(),p=E(),{apiPath:s,apiBaseUrl:r}=p.public,a=u([]),f=u(0),d=u([]);function D(t){d.value=[...t]}async function g({product:t,qty:o=1}){if(!(t!=null&&t.id))return;t.qty=o,t.product_id=t.id;const h={method:"POST",body:{data:{product_id:t.id,qty:o}}};try{const e=await $fetch(`${r}/api/${s}/cart`,{...h});console.log("res",e.data),console.log("cartData: ",a);const n=a.value.findIndex(_=>_.product_id===e.data.product_id);n!==-1?a.value[n].qty++:a.value.push(e.data)}catch(e){console.error(e)}}async function m(){const t={method:"GET"};try{const o=await $fetch(`${r}/api/${s}/cart`,{...t});console.log("res",o),a.value=o.data.carts,f.value=o.data.final_total}catch(o){console.error(o)}}async function T(t){const{qty:o,id:c}=t,e={method:"PUT",body:{data:{product_id:t.product.id,qty:o}}},n=`${r}/api/${s}/cart/${c}`;try{const y=await $fetch(n,{...e});console.log(y),t.originQty=t.qty}catch(y){console.error(y)}}async function C(){l.value?v():S()}async function S(){for(let t=0;t<d.value.length;t++){const o=d.value[t],c=`${r}/api/${s}/cart/${o}`,h={method:"DELETE"};try{const e=await $fetch(c,{...h});console.log(e),a.value=a.value.filter(n=>n.id!==o)}catch(e){console.error(e)}}i(),d.value=[],f.value=a.value.reduce((t,o)=>t+o.final_total,0)}async function v(){const t=`${r}/api/${s}/carts`,o={method:"DELETE"};try{const c=await $fetch(t,{...o});console.log(c),a.value=[]}catch(c){console.error(c)}finally{i(),f.value=0}}return{cartData:a,deleteProductsIdArray:d,final_total:f,addProductToCart:g,updDelProdId:D,getCartData:m,updateProductQty:T,deleteProduct:C,deleteAllProducts:v}});export{$ as a,A as u};
