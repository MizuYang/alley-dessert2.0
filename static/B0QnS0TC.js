import{P as O,r as i,L as S,H as P,K as w}from"./CsCRyp1z.js";import{u as C}from"./ChcSmFmS.js";const T=O("useOrderStore",()=>{var m;const s=i({name:"xxx",email:"xxx@gmail.com",tel:"0900000000",pay_method:"超商取貨付款",address:"xxx"}),c=i({}),{cartDataInit:f}=C(),a=S(),y=P(),h=w(),{apiPath:d,apiBaseUrl:u}=h.public,t=i(((m=a==null?void 0:a.query)==null?void 0:m.orderId)||"");function l(r){t.value=r}async function I(){var e,p;const r=((e=a==null?void 0:a.query)==null?void 0:e.orderId)||t.value||"";if(t.value=r,!r)return;l(r);const n={method:"GET"};try{const o=await $fetch(`${u}/api/${d}/order/${r}`,{...n});console.log("res",o),(p=o==null?void 0:o.order)!=null&&p.id&&(c.value={...o.order,...o.order.user,orderId:r})}catch(o){console.error(o)}}async function $(){const r=`${u}/api/${d}/order`,n={method:"POST",body:{data:{user:s.value}}};try{const e=await $fetch(r,{...n});return console.log("res",e),g(),f(),e.orderId}catch(e){console.error(e)}}function v(){c.value={}}async function x(){console.log("orderId",t.value);const r=`${u}/api/${d}/pay/${t.value}`,n={method:"POST"};try{const e=await $fetch(r,{...n});console.log("res",e),y.push(`/orderComplated?orderId=${t.value}`)}catch(e){console.error(e)}}function g(){s.value={pay_method:"-請選擇付款方式-"}}return{orderId:t,orderInfoForm:s,orderPaymentData:c,getOrderId:l,getOrder:I,clearOrderData:v,sendOrder:$,payment:x}});export{T as u};
