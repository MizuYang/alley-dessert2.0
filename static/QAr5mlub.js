import{_ as E}from"./CyhzVyVC.js";import{_ as L}from"./D1gEUE7Y.js";import{_ as N}from"./aN9q5imw.js";import{_ as R}from"./CiPWUeym.js";import{C as V,o as a,c as i,b as m,w as v,d as F,a as t,n as $,u as l,D as B,r as h,_ as A,s as S,E as U,F as I,q as k,t as _,v as C,G as O,H as P,m as w,z as j,I as z,A as H,B as D}from"./7L-wg891.js";import{_ as G}from"./_PbEniVj.js";import{a as X}from"./BpIcjdmt.js";import{u as M}from"./DOghqgj3.js";const J={class:"flex items-center justify-between"},K=["disabled"],Q={__name:"footer",props:{cartData:{type:Array,required:!0},isCartDataLoading:{type:Boolean,required:!0}},emits:["nextStep"],setup(f,{emit:d}){const n=f,c=d,s=V(()=>!n.cartData.length||n.isCartDataLoading);return(b,u)=>{const g=R;return a(),i("footer",J,[m(g,{to:"/carts",class:"bg-gray-800 px-3 py-2 text-xl hover:bg-gray-700/90 active:bg-gray-600/80"},{default:v(()=>u[1]||(u[1]=[F("上一步")])),_:1}),t("button",{type:"button",class:$(["px-3 py-2 text-xl",l(s)?"cursor-not-allowed bg-gray-400 hover:bg-gray-400/90 active:bg-gray-400/80":"bg-red-800 hover:bg-red-700/90 active:bg-red-600/80"]),onClick:u[0]||(u[0]=y=>l(s)||c("nextStep")),disabled:l(s)}," 下一步 ",10,K)])}}},W=B("useOrderConfirmStore",()=>({form:h({payMethod:"-請選擇付款方式-"})})),Y=["for"],Z={class:"mb-2 inline-block font-bold"},ee=["type","id","placeholder","onUpdate:modelValue"],te=["id","onUpdate:modelValue"],oe=["disabled","selected"],re={key:2,class:"mt-2 inline-block text-xl font-bold text-red-500"},se={__name:"orderManInfo",setup(f,{expose:d}){const{form:n}=S(W()),c=h([{inputType:"input",type:"text",label:"姓名",id:"name",placeholder:"請輸入姓名",isInvalid:null,requireErrorMsg:"*姓名 為必填"},{inputType:"input",type:"email",label:"E-mail",id:"email",placeholder:"請輸入信箱, 例：xxx@gmail.com.tw",isInvalid:null,requireErrorMsg:"*請輸入正確的信箱, 例：xxx@gmail.com.tw",isCustomRule:!0,rule:r=>/^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/g.test(r)},{inputType:"input",type:"tel",label:"電話",id:"tel",placeholder:"請輸入電話 / 例：0912345678",isInvalid:null,requireErrorMsg:"*請輸入正確的電話，例: 0912345678",isCustomRule:!0,rule:r=>/^09\d{8}$/g.test(r)},{inputType:"select",label:"付款方式",id:"payMethod",options:["-請選擇付款方式-","超商取貨付款","信用卡","Line Pay"],isInvalid:null,requireErrorMsg:"*付款方式 為必填",isCustomRule:!0,rule:r=>r!=="-請選擇付款方式-"},{inputType:"input",type:"text",label:"地址",id:"address",placeholder:"請輸入地址",isInvalid:null,requireErrorMsg:"*地址 為必填"}]),s=h({}),b=({element:r,animateName:o})=>{const e=X({element:r,animateName:o});typeof e=="function"&&e()};d({submitForm:u});function u(r){console.log(n),g()&&r()}function g(){let r=!0;return c.value.forEach(o=>{const e=s.value[o.id];o.isCustomRule?o.rule(n.value[o.id])?o.isInvalid=!1:(y({element:e,item:o}),r=!1):n.value[o.id]?o.isInvalid=!1:(y({element:e,item:o}),r=!1)}),r}function y({element:r,item:o}){o.isInvalid=!0,b({element:r,animateName:"shakeX"})}return(r,o)=>(a(),i("form",{class:"mb-5",onSubmit:j(u,["prevent"])},[t("h3",null,[U(r.$slots,"title",{},void 0,!0)]),(a(!0),i(I,null,k(l(c),e=>(a(),i("label",{for:e.id,key:e.id,class:"mb-4 inline-block w-full"},[t("span",Z,_(e.label),1),o[0]||(o[0]=t("br",null,null,-1)),e.inputType==="input"?C((a(),i("input",{key:0,type:e.type,class:$(["focus:ring-primary/50 w-full bg-gray-700/80 px-3 py-2 ring-1 ring-gray-400 focus:outline-none focus:ring-4",[{"!ring-red-500":e.isInvalid===!0},{"!ring-green-500":e.isInvalid===!1}]]),ref_for:!0,ref:p=>l(s)[e.id]=p,id:e.id,placeholder:e.placeholder,"onUpdate:modelValue":p=>l(n)[e.id]=p},null,10,ee)),[[O,l(n)[e.id]]]):e.inputType==="select"?C((a(),i("select",{key:1,class:$(["focus:ring-primary/50 w-full bg-gray-700/80 px-3 py-2 ring-1 ring-gray-400 focus:outline-none focus:ring-4",[{"!ring-red-500":e.isInvalid===!0},{"!ring-green-500":e.isInvalid===!1}]]),ref_for:!0,ref:p=>l(s)[e.id]=p,id:e.id,"onUpdate:modelValue":p=>l(n)[e.id]=p},[(a(!0),i(I,null,k(e.options,(p,x)=>(a(),i("option",{key:`opt-${x}`,disabled:x===0,selected:x===0},_(p),9,oe))),128))],10,te)),[[P,l(n)[e.id]]]):w("",!0),e.isInvalid===!0?(a(),i("span",re,_(e.requireErrorMsg),1)):w("",!0)],8,Y))),128))],32))}},le=A(se,[["__scopeId","data-v-b2358ea4"]]),ae={class:"w-full"},ne={class:"group w-[100px] py-3 align-middle"},ie={class:"relative"},de=["src","alt"],ce={class:"py-3 text-center align-middle"},ue={class:"relative py-3 text-center align-middle"},pe={class:"py-3 text-center align-middle"},_e={colspan:"4",class:"py-3 text-right text-xl font-bold"},fe={__name:"orderProductsInfo",props:{cartData:{type:Array,default:()=>[]},final_total:{type:Number,default:0}},setup(f){const d=f;return(n,c)=>(a(),i("div",null,[t("table",ae,[c[1]||(c[1]=t("thead",{class:"align-middle"},[t("tr",{class:"border-primary border-b-2 border-solid text-xl font-bold"},[t("th",{scope:"col",class:"pb-2"},"圖片"),t("th",{scope:"col",class:"pb-2"},"名稱"),t("th",{scope:"col",class:"pb-2"},"數量"),t("th",{scope:"col",class:"pb-2"},"小計")])],-1)),t("tbody",null,[(a(!0),i(I,null,k(d.cartData,s=>(a(),i("tr",{class:"border-primary hover:bg-primary/10 group/table-line border-y border-solid text-xl",key:s.id},[t("td",ne,[t("div",ie,[t("img",{src:s.product.imageUrl,class:"mx-auto block h-[80px] w-[100px] object-cover",alt:s.product.title},null,8,de)])]),t("td",ce,_(s.product.title),1),t("td",ue,_(s.qty),1),t("td",pe,"$"+_(s.final_total),1),c[0]||(c[0]=t("td",{class:"py-3 align-middle"},null,-1))]))),128))]),t("tfoot",null,[t("tr",null,[t("td",_e," 總計: $"+_(d.final_total)+" 元 ",1)])])])]))}},me={class:"pb-14 pt-10"},be={class:"mx-auto max-w-[1200px]"},ge={class:"grid grid-cols-2 items-start gap-x-5"},ye={class:"border-primary mx-auto w-full rounded-3xl border-2 border-solid px-10 py-10 text-xl"},xe={class:"border-primary relative h-full rounded-3xl border-2 border-solid px-10 py-10 text-xl"},Me={__name:"checkout",setup(f){const{cartData:d,final_total:n}=S(M()),{getCartData:c}=M(),s=z(),b=h(null),u=h(!0);H(async()=>{d.value.length||await c(),d.value.length||s.push("/carts"),u.value=!1});function g(){b.value.submitForm(y)}function y(){s.push("/orderConfirm")}return(r,o)=>{const e=E,p=L,x=N,T=Q,q=G;return a(),i("main",me,[t("div",null,[m(e,{title:"填寫資料"})]),t("div",be,[m(p,{class:"mb-12"}),t("div",ge,[t("section",ye,[m(le,{ref_key:"orderManInfoRef",ref:b},{default:v(()=>[m(x,null,{title:v(()=>o[0]||(o[0]=[t("h2",{class:"border-primary mb-6 border-b border-solid text-2xl font-bold"}," 訂購人資料 ",-1)])),_:1})]),_:1},512),m(T,{isCartDataLoading:l(u),cartData:l(d),onNextStep:g},null,8,["isCartDataLoading","cartData"])]),t("section",xe,[!l(u)&&l(d).length?(a(),D(fe,{key:0,cartData:l(d),final_total:l(n)},{title:v(()=>o[1]||(o[1]=[t("h2",{class:"border-primary mb-6 border-b border-solid text-2xl font-bold"}," 訂單明細 ",-1)])),_:1},8,["cartData","final_total"])):(a(),D(q,{key:1}))])])])])}}};export{Me as default};
