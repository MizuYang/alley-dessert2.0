import{_ as F}from"./DYs2Jnmw.js";import{_ as N}from"./Dpjm6Tmp.js";import{_ as V}from"./sOxVxZIv.js";import{C as B,o as l,c as d,b,w as v,d as O,a as e,n as I,u as s,_ as A,s as q,r as $,D as E,F as w,q as k,t as y,v as C,E as P,G as U,m as D,H as j,A as H,B as M}from"./DOkxriL9.js";import{_ as z}from"./DO8KFTFS.js";import{_ as L}from"./bRJ13het.js";import{a as G}from"./BpIcjdmt.js";import{u as R}from"./teGnrIEv.js";import{u as T}from"./D8gQVhjj.js";const X={class:"flex items-center justify-between"},J=["disabled"],K={__name:"footer",props:{cartData:{type:Array,required:!0},isCartDataLoading:{type:Boolean,required:!0}},emits:["nextStep"],setup(x,{emit:c}){const n=x,u=c,p=B(()=>!n.cartData.length||n.isCartDataLoading);return(_,f)=>{const g=V;return l(),d("footer",X,[b(g,{to:"/carts",class:"bg-gray-800 px-3 py-2 text-xl hover:bg-gray-700/90 active:bg-gray-600/80"},{default:v(()=>f[1]||(f[1]=[O("上一步")])),_:1}),e("button",{type:"button",class:I(["px-3 py-2 text-xl",s(p)?"cursor-not-allowed bg-gray-400 hover:bg-gray-400/90 active:bg-gray-400/80":"bg-red-800 hover:bg-red-700/90 active:bg-red-600/80"]),onClick:f[0]||(f[0]=m=>s(p)||u("nextStep")),disabled:s(p)}," 下一步 ",10,J)])}}},Q={class:"mb-5"},W=["for"],Y={class:"mb-2 inline-block font-bold"},Z=["type","id","placeholder","onUpdate:modelValue"],ee=["id","onUpdate:modelValue"],te=["disabled","selected"],re={key:2,class:"mt-2 inline-block text-xl font-bold text-red-500"},oe={__name:"orderManInfo",setup(x,{expose:c}){const{orderInfoForm:n}=q(R()),u=$([{inputType:"input",type:"text",label:"姓名",id:"name",placeholder:"請輸入姓名",isInvalid:null,requireErrorMsg:"*姓名 為必填"},{inputType:"input",type:"email",label:"E-mail",id:"email",placeholder:"請輸入信箱, 例：xxx@gmail.com.tw",isInvalid:null,requireErrorMsg:"*請輸入正確的信箱, 例：xxx@gmail.com.tw",isCustomRule:!0,rule:o=>/^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/g.test(o)},{inputType:"input",type:"tel",label:"電話",id:"tel",placeholder:"請輸入電話 / 例：0912345678",isInvalid:null,requireErrorMsg:"*請輸入正確的電話，例: 0912345678",isCustomRule:!0,rule:o=>/^09\d{8}$/g.test(o)},{inputType:"select",label:"付款方式",id:"pay_method",options:["-請選擇付款方式-","超商取貨付款","信用卡","Line Pay"],isInvalid:null,requireErrorMsg:"*付款方式 為必填",isCustomRule:!0,rule:o=>o!=="-請選擇付款方式-"},{inputType:"input",type:"text",label:"地址",id:"address",placeholder:"請輸入地址",isInvalid:null,requireErrorMsg:"*地址 為必填"}]),p=$({}),_=({element:o,animateName:r})=>{const a=G({element:o,animateName:r});typeof a=="function"&&a()};c({submitForm:f});function f(o){return new Promise(async(r,a)=>{if(!g())return;const i=await o();r(i)})}function g(){let o=!0;return u.value.forEach(r=>{const a=p.value[r.id];r.isCustomRule?r.rule(n.value[r.id])?r.isInvalid=!1:(m({element:a,item:r}),o=!1):n.value[r.id]?r.isInvalid=!1:(m({element:a,item:r}),o=!1)}),o}function m({element:o,item:r}){r.isInvalid=!0,_({element:o,animateName:"shakeX"})}return(o,r)=>{const a=L;return l(),d("form",Q,[e("h3",null,[b(a,null,{default:v(()=>[E(o.$slots,"title",{},void 0,!0)]),_:3})]),(l(!0),d(w,null,k(s(u),t=>(l(),d("label",{for:t.id,key:t.id,class:"mb-4 inline-block w-full"},[e("span",Y,y(t.label),1),r[0]||(r[0]=e("br",null,null,-1)),t.inputType==="input"?C((l(),d("input",{key:0,type:t.type,class:I(["focus:ring-primary/50 w-full bg-gray-700/80 px-3 py-2 ring-1 ring-gray-400 focus:outline-none focus:ring-4",[{"!ring-red-500":t.isInvalid===!0},{"!ring-green-500":t.isInvalid===!1}]]),ref_for:!0,ref:i=>s(p)[t.id]=i,id:t.id,placeholder:t.placeholder,"onUpdate:modelValue":i=>s(n)[t.id]=i},null,10,Z)),[[P,s(n)[t.id]]]):t.inputType==="select"?C((l(),d("select",{key:1,class:I(["focus:ring-primary/50 w-full bg-gray-700/80 px-3 py-2 ring-1 ring-gray-400 focus:outline-none focus:ring-4",[{"!ring-red-500":t.isInvalid===!0},{"!ring-green-500":t.isInvalid===!1}]]),ref_for:!0,ref:i=>s(p)[t.id]=i,id:t.id,"onUpdate:modelValue":i=>s(n)[t.id]=i},[(l(!0),d(w,null,k(t.options,(i,h)=>(l(),d("option",{key:`opt-${h}`,disabled:h===0,selected:h===0},y(i),9,te))),128))],10,ee)),[[U,s(n)[t.id]]]):D("",!0),t.isInvalid===!0?(l(),d("span",re,y(t.requireErrorMsg),1)):D("",!0)],8,W))),128))])}}},se=A(oe,[["__scopeId","data-v-96b04a07"]]),le={class:"w-full"},ne={class:"group w-[100px] py-3 align-middle"},ae={class:"relative"},ie=["src","alt"],de={class:"py-3 text-center align-middle"},ce={class:"relative py-3 text-center align-middle"},ue={class:"py-3 text-center align-middle"},pe={colspan:"4",class:"py-3 text-right text-xl font-bold"},_e={__name:"orderProductsInfo",props:{cartData:{type:Array,default:()=>[]},final_total:{type:Number,default:0}},setup(x){const c=x;return(n,u)=>{const p=L;return l(),d("div",null,[e("h3",null,[b(p,null,{default:v(()=>[E(n.$slots,"title")]),_:3})]),e("table",le,[u[1]||(u[1]=e("thead",{class:"align-middle"},[e("tr",{class:"border-primary border-b-2 border-solid text-xl font-bold"},[e("th",{scope:"col",class:"pb-2"},"圖片"),e("th",{scope:"col",class:"pb-2"},"名稱"),e("th",{scope:"col",class:"pb-2"},"數量"),e("th",{scope:"col",class:"pb-2"},"小計")])],-1)),e("tbody",null,[(l(!0),d(w,null,k(c.cartData,_=>(l(),d("tr",{class:"border-primary hover:bg-primary/10 group/table-line border-y border-solid text-xl",key:_.id},[e("td",ne,[e("div",ae,[e("img",{src:_.product.imageUrl,class:"mx-auto block h-[80px] w-[100px] object-cover",alt:_.product.title},null,8,ie)])]),e("td",de,y(_.product.title),1),e("td",ce,y(_.qty),1),e("td",ue,"$"+y(_.final_total),1),u[0]||(u[0]=e("td",{class:"py-3 align-middle"},null,-1))]))),128))]),e("tfoot",null,[e("tr",null,[e("td",pe," 總計: $"+y(c.final_total)+" 元 ",1)])])])])}}},fe={class:"pb-14 pt-10"},me={class:"mx-auto max-w-[1200px]"},be={class:"grid grid-cols-2 items-start gap-x-5"},ye={class:"border-primary mx-auto w-full rounded-3xl border-2 border-solid px-10 py-10 text-xl"},ge={class:"border-primary relative h-full rounded-3xl border-2 border-solid px-10 py-10 text-xl"},Me={__name:"checkout",setup(x){const{cartData:c,final_total:n}=q(T()),{getCartData:u}=T(),{sendOrder:p,getOrderId:_}=R(),f=j(),g=$(null),m=$(!0);H(async()=>{c.value.length||await u(),c.value.length||f.push("/carts"),m.value=!1});async function o(){const r=await g.value.submitForm(p);r&&(_(r),f.push(`/orderPayment?orderId=${r}`))}return(r,a)=>{const t=F,i=N,h=K,S=z;return l(),d("main",fe,[e("div",null,[b(t,{title:"填寫資料"})]),e("div",me,[b(i,{class:"mb-12"}),e("div",be,[e("section",ye,[b(se,{ref_key:"orderManInfoRef",ref:g},{title:v(()=>a[0]||(a[0]=[e("h2",{class:"border-primary mb-6 border-b border-solid text-2xl font-bold"}," 訂購人資料 ",-1)])),_:1},512),b(h,{isCartDataLoading:s(m),cartData:s(c),onNextStep:o},null,8,["isCartDataLoading","cartData"])]),e("section",ge,[!s(m)&&s(c).length?(l(),M(_e,{key:0,cartData:s(c),final_total:s(n)},{title:v(()=>a[1]||(a[1]=[e("h2",{class:"border-primary mb-6 border-b border-solid text-2xl font-bold"}," 訂單明細 ",-1)])),_:1},8,["cartData","final_total"])):(l(),M(S,{key:1}))])])])])}}};export{Me as default};
